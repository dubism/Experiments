<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
<title>Human Sounds ‚Äî Deterministic UI Sampler (v2)</title>
<style>
  :root{ --bg:#f8fafc; --ink:#1e2430; --muted:#5c6a7c; --card:#ffffff; --line:#e6eaf1; --shadow:0 8px 24px rgba(16,24,40,.06), 0 1px 0 rgba(16,24,40,.06);
          --peach:#ffd9c2; --mint:#c8f1e7; --sky:#d5e8ff; --rose:#ffd6e7; --lemon:#fbf3ba; --lilac:#e7dcff; --sage:#d9f0d7; --blue:#cfe0ff; --accent:#7f8cff; }
  *{box-sizing:border-box} html,body{height:100%} body{margin:0; font:16px/1.5 ui-sans-serif,system-ui,Inter,Roboto,Segoe UI,Helvetica,Arial,sans-serif; color:var(--ink); background:var(--bg);}
  header{position:sticky; top:0; z-index:5; backdrop-filter:saturate(120%) blur(8px); background:linear-gradient(180deg, rgba(255,255,255,.85), rgba(255,255,255,.6)); border-bottom:1px solid var(--line);}
  .wrap{max-width:1200px; margin:0 auto; padding:22px 16px} h1{margin:0; font-size:28px} .sub{color:var(--muted); margin-top:6px; font-size:14px}
  .grid{display:grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap:16px; margin-top:18px} .card{background:var(--card); border:1px solid var(--line); border-radius:14px; box-shadow:var(--shadow); padding:16px}
  .card h2{margin:0 0 10px 0; font-size:16px} .row{display:flex; flex-wrap:wrap; align-items:center; gap:10px}
  .btn{appearance:none; border:0; padding:10px 14px; border-radius:12px; font-weight:700; letter-spacing:.2px; cursor:pointer; transition:transform .12s ease, box-shadow .2s ease, filter .15s ease; box-shadow:0 2px 0 rgba(0,0,0,.04) inset, 0 10px 20px rgba(0,0,0,.05);}
  .btn:active{transform:translateY(0) scale(.985)} .primary{background:var(--blue)} .secondary{background:var(--mint)} .ghost{background:transparent; border:1px dashed var(--line)} .danger{background:var(--rose)}
  .btn .subcap{display:block; font-size:11px; font-weight:600; color:#3a4250; opacity:.9}
  .choice{display:flex; gap:16px; align-items:center; flex-wrap:wrap} .radio, .check{display:flex; gap:8px; align-items:center; background:#f2f5fb; border:1px solid var(--line); border-radius:12px; padding:8px 10px; cursor:pointer}
  .radio input, .check input{accent-color:#7f8cff; width:18px; height:18px}
  .toggle{position:relative; width:60px; height:32px; background:#e9edf3; border:1px solid var(--line); border-radius:999px; cursor:pointer; transition:background .2s ease}
  .toggle::after{content:""; position:absolute; top:3px; left:3px; width:26px; height:26px; background:#fff; border-radius:50%; box-shadow:0 4px 10px rgba(0,0,0,.12); transition:transform .2s ease;}
  .toggle.on{background:#d9e8ff} .toggle.on::after{transform:translateX(28px)}
  .slider{appearance:none; width:100%; height:10px; background:#edf1f6; border-radius:999px; border:1px solid var(--line);}
  .slider::-webkit-slider-thumb{appearance:none; width:22px; height:22px; border-radius:50%; background:var(--accent); border:0; cursor:pointer; box-shadow:0 6px 16px rgba(0,0,0,.15);}
  .dial, .knob{width:140px; height:140px; border-radius:50%; display:grid; place-items:center; margin:8px auto; background:#fff; border:1px solid var(--line); box-shadow:var(--shadow); position:relative;}
  .dial::after, .knob::after{content:""; position:absolute; width:6px; height:30px; background:var(--accent); top:14px; left:50%; transform-origin:50% 50%; border-radius:3px}
  .dial .val, .knob .val{font-weight:700} .ticks{position:absolute; inset:6px; border-radius:50%; pointer-events:none; opacity:.5} .ticks canvas{width:100%; height:100%}
  .board{display:grid; grid-template-columns:1fr 1fr; gap:12px} .bin{min-height:140px; border:2px dashed #dbe3ef; border-radius:14px; padding:10px; background:#f7faff}
  .token{user-select:none; display:inline-block; padding:8px 12px; border-radius:999px; background:#fff; border:1px solid var(--line); box-shadow:var(--shadow); margin:4px; cursor:grab}
  .token:active{cursor:grabbing} .bin h3{margin:0 0 8px 0; font-size:14px; color:var(--muted)}
  .scrim{position:fixed; inset:0; background:rgba(10,12,16,.4); display:none; place-items:center; z-index:30} .modal{width:min(560px,calc(100vw - 32px)); background:#fff; border:1px solid var(--line); border-radius:16px; padding:18px; box-shadow:var(--shadow)}
  .toast-wrap{position:fixed; right:14px; bottom:14px; display:flex; flex-direction:column; gap:8px; z-index:40} .toast{background:#1f2530; color:#fff; padding:10px 12px; border-radius:12px; box-shadow:var(--shadow)} .toast.error{background:#e35050}
  .lab{height:220px; border:2px dashed #dbe3ef; border-radius:14px; position:relative; overflow:hidden; background:linear-gradient(180deg,#ffffff,#f6f9ff)}
  .anchor{position:absolute; left:50%; top:50%; width:18px; height:18px; background:#7f8cff; border-radius:50%; transform:translate(-50%,-50%)}
  .mass{position:absolute; left:50%; top:50%; width:36px; height:36px; background:#ffdaba; border:2px solid #ffb98a; border-radius:50%; transform:translate(-50%,-50%); box-shadow:0 8px 18px rgba(0,0,0,.08);}
  .vector{position:absolute; left:50%; top:50%; width:2px; height:2px; background:#7f8cff; transform-origin:0 0} .lab .hint{position:absolute; left:8px; top:8px; font-size:12px; color:var(--muted)}
  footer{margin-top:18px; color:var(--muted)} code{background:#eef2f8; padding:2px 6px; border-radius:6px}
</style>
</head>
<body>
<header><div class="wrap"><h1>Human Sounds ‚Äî Deterministic UI Sampler</h1><div class="sub">Each sound is mapped once. No randomness. Buttons: press vs. release. Knobs: scrub & snap. Drag, drop, and a springy gesture lab.</div></div></header>
<main class="wrap">
  <section class="grid">
    <div class="card">
      <h2>üéõÔ∏è Buttons (distinct states)</h2>
      <div class="row">
        <button class="btn primary" id="btnPrimary">Commit<span class="subcap">sound on release</span></button>
        <button class="btn secondary" id="btnSecondary">Nudge<span class="subcap">sound on press</span></button>
        <button class="btn ghost" id="btnGhost">Outline<span class="subcap">sound on release</span></button>
        <button class="btn danger" id="btnPanic">Panic<span class="subcap">error toast</span></button>
      </div>
    </div>
    <div class="card">
      <h2>‚úÖ Choices</h2>
      <div class="choice" role="radiogroup" aria-label="Modes">
        <label class="radio"><input type="radio" name="mode" value="Luna" checked/> Luna</label>
        <label class="radio"><input type="radio" name="mode" value="Kite"/> Kite</label>
        <label class="radio"><input type="radio" name="mode" value="Echo"/> Echo</label>
      </div>
      <div style="height:10px"></div>
      <label class="check"><input type="checkbox" id="agree"/> Accept</label>
      <div style="height:10px"></div>
      <div class="label">Glow</div>
      <div id="toggleGlow" class="toggle" role="switch" aria-checked="false" tabindex="0"></div>
      <div class="sub" style="margin-top:6px">Radio: sound on change. Checkbox: sound on change. Toggle: visual only.</div>
    </div>
    <div class="card">
      <h2>ü™Ñ Overlay & Melt</h2>
      <div class="row">
        <button class="btn" style="background:var(--lilac)" id="openOverlay">Show Overlay</button>
        <button class="btn" style="background:var(--sage)" id="melt">Melt Card</button>
      </div>
      <div class="sub" style="margin-top:6px">Overlay sounds swapped: show ‚Üí <code>clip_004</code>, hide ‚Üí <code>clip_006</code>. Melt uses <code>clip_003</code>.</div>
    </div>
    <div class="card">
      <h2>üéöÔ∏è Slider (populated by shortest sound)</h2>
      <div><div>Steps: <span id="sliderOut">0</span></div><input id="stepSlider" class="slider" type="range" min="0" max="100" step="5" value="0"/></div>
      <div class="sub" style="margin-top:6px">Tick uses <code>clip_008</code> (quick).</div>
    </div>
    <div class="card">
      <h2>üß≠ Knobs ‚Äî Scrub vs. Snap</h2>
      <div class="row" style="justify-content:space-between">
        <div style="flex:1">
          <div class="dial" id="dial"><div class="val"><span id="dialVal">0</span>¬∞</div></div>
          <div class="sub" style="text-align:center">Scrub freely (no snap). Rotate plays <code>clip_010</code> when you release.</div>
        </div>
        <div style="flex:1">
          <div class="knob" id="knob"><div class="val"><span id="knobVal">0</span>¬∞</div><div class="ticks"><canvas id="tickCanvas" width="140" height="140"></canvas></div></div>
          <div class="sub" style="text-align:center">Snaps every 30¬∞. Detent click uses <code>clip_024</code>.</div>
        </div>
      </div>
    </div>
    <div class="card">
      <h2>üß≤ Drag & Drop Board</h2>
      <div class="board">
        <div class="bin" id="binA"><h3>Nest</h3></div>
        <div class="bin" id="binB"><h3>Orbit</h3></div>
      </div>
      <div class="sub" style="margin-top:6px">Friction while dragging: <code>clip_021</code>. Successful drop: <code>clip_013</code>.</div>
    </div>
    <div class="card">
      <h2>üß™ Gesture Lab ‚Äî Spring</h2>
      <div class="lab" id="lab">
        <div class="hint">Drag the mass from center. Grab (<code>clip_025</code>), tension (<code>clip_022</code>), release (<code>clip_023</code>). Rate & volume modulate with angle/force.</div>
        <div class="anchor"></div><div class="mass" id="mass"></div><div class="vector" id="vector"></div>
      </div>
    </div>
  </section>
  <footer>
    <div>Included sounds: <code id="have"></code></div>
    <div>Missing (for reference): <code id="missing"></code></div>
  </footer>
</main>
<div class="scrim" id="scrim" aria-hidden="true"><div class="modal"><h3>Nova appears ‚ú®</h3><p>Overlay sound mapping is reversed by design.</p><div class="row" style="margin-top:10px"><button class="btn secondary" id="closeOverlay">Dismiss</button></div></div></div>
<div class="toast-wrap" id="toasts"></div>
<script>
const MAP = {"error": "clip_001", "btn_primary": "clip_002", "melt_card": "clip_003", "overlay_show": "clip_004", "overlay_hide": "clip_006", "slider_tick": "clip_008", "dial_rotate": "clip_010", "dnd_drop_success": "clip_013", "btn_secondary": "clip_017", "btn_ghost": "clip_018", "radio_select": "clip_019", "checkbox_toggle": "clip_020", "dnd_friction": "clip_021", "spring_tension": "clip_022", "spring_release": "clip_023", "snap_knob_detent": "clip_024", "spring_grab": "clip_025"};
const HAVE = new Set(["clip_001", "clip_002", "clip_003", "clip_004", "clip_006", "clip_008", "clip_010", "clip_013", "clip_017", "clip_018", "clip_019", "clip_020", "clip_021", "clip_022", "clip_023", "clip_024", "clip_025"]);
const MISSING = [];
class Pool { constructor(id, voices=5) { this.id=id; this.src=id?`sounds/$<built-in function id>.wav`:null; this.vo=[]; for(let i=0;i<voices;i++){const a=new Audio(this.src||""); a.preload="auto"; this.vo.push(a);} this.i=0; } play({rate=1, vol=1}={}){ if(!this.src) return; const a=this.vo[this.i++%this.vo.length]; try{ a.pause(); a.currentTime=0; a.playbackRate=rate; a.volume=Math.max(0,Math.min(1,vol)); a.play(); }catch(e){} } }
const pools = {}; for (const [k, id] of Object.entries(MAP)) { pools[k] = new Pool(id); }
document.getElementById('have').textContent = Array.from(HAVE).sort().join(', ');
document.getElementById('missing').textContent = MISSING.join(', ');
let unlocked=false; window.addEventListener('pointerdown',()=>{ if(unlocked) return; unlocked=true; pools.btn_primary.play({vol:0.0001}); },{once:true});
const toasts = document.getElementById('toasts'); function toast(text, kind="ok", life=1800) { const el = document.createElement('div'); el.className = 'toast' + (kind==="error" ? ' error' : ''); el.textContent = text; toasts.appendChild(el); setTimeout(()=>{ el.remove(); }, life); }
const btnPrimary = document.getElementById('btnPrimary'); btnPrimary.addEventListener('pointerup', ()=>{ pools.btn_primary.play(); btnPrimary.animate([{transform:'scale(1)'},{transform:'scale(1.05)'},{transform:'scale(1)'}],{duration:160}) });
const btnSecondary = document.getElementById('btnSecondary'); btnSecondary.addEventListener('pointerdown', ()=>{ pools.btn_secondary.play(); btnSecondary.animate([{transform:'translateY(0)'},{transform:'translateY(-2px)'},{transform:'translateY(0)'}],{duration:140}) });
const btnGhost = document.getElementById('btnGhost'); btnGhost.addEventListener('pointerup', ()=>{ pools.btn_ghost.play(); btnGhost.animate([{filter:'none'},{filter:'brightness(1.08)'},{filter:'none'}],{duration:180}) });
const btnPanic = document.getElementById('btnPanic'); btnPanic.addEventListener('click', ()=>{ pools.error.play(); toast('Critical: something broke.', 'error', 1600); });
document.querySelectorAll('input[name="mode"]').forEach(r=>{ r.addEventListener('change', ()=>{ if(r.checked) pools.radio_select.play(); }); });
document.getElementById('agree').addEventListener('change', ()=>{ pools.checkbox_toggle.play(); });
const toggleGlow = document.getElementById('toggleGlow'); const setToggle=(on)=>{ toggleGlow.classList.toggle('on', on); toggleGlow.setAttribute('aria-checked', on?'true':'false'); }; toggleGlow.addEventListener('click', ()=>setToggle(!toggleGlow.classList.contains('on'))); toggleGlow.addEventListener('keydown', (e)=>{ if(e.key===' '||e.key==='Enter'){ e.preventDefault(); setToggle(!toggleGlow.classList.contains('on')); } });
const scrim = document.getElementById('scrim'); document.getElementById('openOverlay').addEventListener('click', ()=>{ scrim.style.display='grid'; pools.overlay_show.play(); });
document.getElementById('closeOverlay').addEventListener('click', ()=>{ scrim.style.display='none'; pools.overlay_hide.play(); }); scrim.addEventListener('click', (e)=>{ if(e.target===scrim){ scrim.style.display='none'; pools.overlay_hide.play(); } });
document.getElementById('melt').addEventListener('click', ()=>{ pools.melt_card.play(); const tmp=document.createElement('div'); tmp.className='toast'; tmp.textContent='Melting‚Ä¶'; toasts.appendChild(tmp); tmp.animate([{opacity:1},{opacity:0}],{duration:750, fill:'forwards'}); setTimeout(()=>tmp.remove(),760); });
const stepSlider = document.getElementById('stepSlider'); const sliderOut = document.getElementById('sliderOut'); let lastStep = 0;
stepSlider.addEventListener('input', (e)=>{ const v = +e.target.value; const step = Math.round(v/5); sliderOut.textContent = v; if (step !== lastStep) { lastStep = step; pools.slider_tick.play(); } });
function getAngle(el, ev){ const r=el.getBoundingClientRect(); const cx=r.left+r.width/2, cy=r.top+r.height/2; const x=(ev.clientX|| (ev.touches&&ev.touches[0].clientX)), y=(ev.clientY||(ev.touches&&ev.touches[0].clientY)); return Math.atan2(y-cy, x-cx)*180/Math.PI + 90; }
const dial = document.getElementById('dial'); const dialVal = document.getElementById('dialVal'); let dialGrab=false, dialAngle=0;
dial.addEventListener('pointerdown', (e)=>{ dialGrab=true; dial.setPointerCapture(e.pointerId); });
window.addEventListener('pointermove', (e)=>{ if(!dialGrab) return; dialAngle = (getAngle(dial, e)+360)%360; dial.style.transform = `rotate(${dialAngle}deg)`; dialVal.textContent = Math.round(dialAngle); });
window.addEventListener('pointerup', ()=>{ if(!dialGrab) return; dialGrab=false; pools.dial_rotate.play(); });
const knob = document.getElementById('knob'); const knobVal = document.getElementById('knobVal'); const tickCanvas = document.getElementById('tickCanvas'); const ctx = tickCanvas.getContext('2d');
function drawTicks(){ const c=tickCanvas; const cx=c.width/2, cy=c.height/2; ctx.clearRect(0,0,c.width,c.height); for(let a=0;a<360;a+=30){ const rad=(a-90)*Math.PI/180; const r1=48, r2=60; ctx.beginPath(); ctx.moveTo(cx+Math.cos(rad)*r1, cy+Math.sin(rad)*r1); ctx.lineTo(cx+Math.cos(rad)*r2, cy+Math.sin(rad)*r2); ctx.strokeStyle="#b8c3d9"; ctx.lineWidth=2; ctx.stroke(); } } drawTicks();
let kGrab=false, kAngle=0, lastDetent=null; knob.addEventListener('pointerdown', (e)=>{ kGrab=true; knob.setPointerCapture(e.pointerId); });
window.addEventListener('pointermove', (e)=>{ if(!kGrab) return; const ang=(getAngle(knob,e)+360)%360; const det=Math.round(ang/30)*30%360; knob.style.transform=`rotate(${det}deg)`; knobVal.textContent=det; if(det!==lastDetent){ pools.snap_knob_detent.play(); lastDetent=det; } });
window.addEventListener('pointerup', ()=>{ if(!kGrab) return; kGrab=false; });
const binA = document.getElementById('binA'); const binB = document.getElementById('binB'); const tokens = ['Luma','Sprig','Echo'];
function makeToken(name){ const el=document.createElement('div'); el.className='token'; el.textContent=name; el.draggable=true; el.addEventListener('dragstart',()=>{ pools.dnd_friction.play({vol:.6}); }); return el; }
tokens.forEach((t)=> binA.appendChild(makeToken(t)));
;[binA,binB].forEach(bin=>{ bin.addEventListener('dragover',(e)=>{ e.preventDefault(); }); bin.addEventListener('drop',(e)=>{ e.preventDefault(); const dragging = document.querySelector('.dragging'); if(dragging){ bin.appendChild(dragging); pools.dnd_drop_success.play(); } }); });
document.addEventListener('dragstart', (e)=>{ if(e.target.classList.contains('token')) e.target.classList.add('dragging'); });
document.addEventListener('dragend', (e)=>{ if(e.target.classList.contains('token')) e.target.classList.remove('dragging'); });
const lab = document.getElementById('lab'); const mass = document.getElementById('mass'); const vector = document.getElementById('vector'); let mGrab=false; let vx=0, vy=0; let px=0, py=0; const springK=0.018; const damping=0.12;
function setMass(x,y){ mass.style.left = x+'px'; mass.style.top = y+'px'; mass.style.transform = 'translate(-50%,-50%)'; }
function setVector(cx,cy,x,y){ const dx=x-cx, dy=y-cy; const len=Math.hypot(dx,dy); const angle=Math.atan2(dy,dx); vector.style.left=cx+'px'; vector.style.top=cy+'px'; vector.style.width=len+'px'; vector.style.transform = `rotate(${angle}rad)`; }
lab.addEventListener('pointerdown',(e)=>{ const r=lab.getBoundingClientRect(); mGrab=true; lab.setPointerCapture(e.pointerId); pools.spring_grab.play(); });
lab.addEventListener('pointermove',(e)=>{ if(!mGrab) return; const r=lab.getBoundingClientRect(); const cx=r.width/2, cy=r.height/2; const x=e.clientX - r.left, y=e.clientY - r.top; px=x; py=y; setMass(x,y); setVector(cx,cy,x,y); const dx=x-cx, dy=y-cy; const angDeg=((Math.atan2(dy,dx)*180/Math.PI)+360)%360; const dist=Math.min(1, Math.hypot(dx,dy)/Math.min(r.width,r.height)); const rate = 0.85 + (angDeg/360)*0.4; const vol  = 0.2 + dist*0.6; const now = performance.now(); if(!lab._lastT || now - lab._lastT > 380){ pools.spring_tension.play({rate, vol}); lab._lastT = now; } });
lab.addEventListener('pointerup',()=>{ if(!mGrab) return; mGrab=false; const vmag = Math.min(1.6, Math.hypot(vx,vy)/8 + 1); pools.spring_release.play({rate: vmag, vol: 0.8}); });
function tick(){ const r=lab.getBoundingClientRect(); const cx=r.width/2, cy=r.height/2; if(!mGrab){ const el=mass.getBoundingClientRect(); let x=el.left - r.left + el.width/2, y=el.top - r.top + el.height/2; const dx=cx-x, dy=cy-y; const ax=dx*0.018, ay=dy*0.018; vx+=ax; vy+=ay; vx*=(1-0.12); vy*=(1-0.12); x+=vx; y+=vy; setMass(x,y); setVector(cx,cy,x,y); } requestAnimationFrame(tick); }
(function init(){ const r=lab.getBoundingClientRect(); setMass(r.width/2, r.height/2); requestAnimationFrame(tick); })();
</script>
</body>
</html>
