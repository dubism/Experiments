<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>Emoji Mixer â€” Bowl + Buttons + Bottom Carousel</title>
<style>
  :root{
    --t1:#7fd1ff40; --t2:#ff86d640; --t3:#7dffcc40; --t4:#b59bff40;
    --ring2:#00000012; --shadow:0 8px 24px #0000001e,0 2px 8px #00000012;
    --shadow-strong:0 14px 40px #00000026,0 4px 16px #0000001f;
    --ease:cubic-bezier(.2,.8,.2,1);
    --emerald:#9af2d3; --emerald-mid:#48d9ad; --emerald-deep:#0ca678;
    --ink:#0a0b0d;
    --shake-ampl:0;   /* 0â†’1 (CSS-animated while waiting) */
    --blur:0px;       /* 0â†’3px (CSS-animated while waiting) */
  }
  @property --shake-ampl{syntax:'<number>';initial-value:0;inherits:false}
  @property --blur{syntax:'<length>';initial-value:0px;inherits:false}

  html,body{height:100%;margin:0}
  body{
    background:
      radial-gradient(60vmax 60vmax at 15% 10%, var(--t1), transparent 60%),
      radial-gradient(70vmax 60vmax at 85% 20%, var(--t2), transparent 60%),
      radial-gradient(60vmax 70vmax at 20% 85%, var(--t3), transparent 60%),
      radial-gradient(70vmax 70vmax at 80% 85%, var(--t4), transparent 60%),
      conic-gradient(from 0deg at 50% 50%, #e9f3ff, #ffe9f7, #e9fff6, #f7f3ff, #e9f3ff);
    background-attachment:fixed; animation:hue 24s linear infinite alternate;
    overflow:hidden; -webkit-tap-highlight-color:transparent;
    user-select:none; color:var(--ink);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial, sans-serif;
  }
  @keyframes hue{to{filter:hue-rotate(12deg) saturate(1.05)}}

  /* Layout: Bowl (fills) â†’ Buttons â†’ Carousel (at bottom). */
  .stage{
    position:fixed; inset:0;
    display:grid; grid-template-rows:1fr auto auto;
    gap:10px; padding:10px 12px calc(env(safe-area-inset-bottom,16px) + 6px);
  }

  /* ---------- BOWL ---------- */
  .centerWrap{ display:grid; place-items:center; min-height:0 }
  .cauldron-wrap{
    position:relative; width:min(64vmin,520px); aspect-ratio:1;
    display:grid; place-items:center;
    animation:shake-linear 700ms linear infinite;
    transform:translate(0,0);
  }
  @media (max-height:740px){ .cauldron-wrap{ width:min(56vmin,460px); } }
  @media (max-height:640px){ .cauldron-wrap{ width:min(50vmin,420px); } }

  @keyframes shake-linear{
    0%  { transform: translate( calc( 0px * var(--shake-ampl)),  calc( 0px * var(--shake-ampl))); }
    12% { transform: translate( calc( 2px * var(--shake-ampl)),  calc(-2px * var(--shake-ampl))); }
    25% { transform: translate( calc(-2px * var(--shake-ampl)),  calc( 2px * var(--shake-ampl))); }
    37% { transform: translate( calc( 2px * var(--shake-ampl)),  calc( 2px * var(--shake-ampl))); }
    50% { transform: translate( calc(-2px * var(--shake-ampl)),  calc(-2px * var(--shake-ampl))); }
    62% { transform: translate( calc( 1px * var(--shake-ampl)),  calc(-1px * var(--shake-ampl))); }
    75% { transform: translate( calc(-1px * var(--shake-ampl)),  calc( 1px * var(--shake-ampl))); }
    87% { transform: translate( calc( 1px * var(--shake-ampl)),  calc( 1px * var(--shake-ampl))); }
    100%{ transform: translate( calc( 0px * var(--shake-ampl)),  calc( 0px * var(--shake-ampl))); }
  }

  .cauldron{
    position:relative; width:100%; height:100%; border-radius:50%;
    background:radial-gradient(120% 120% at 70% 30%, #ffffffc0, #ffffff60 45%, #ffffff30 60%, #ffffff12 75%, #ffffff06 100%);
    box-shadow:var(--shadow-strong), inset 0 1px 0 #ffffffa0, inset 0 -20px 60px #0000000b;
    outline:1px solid var(--ring2);
    overflow:hidden; display:grid; place-items:center;
  }
  .ring{ position:absolute; inset:6%; border-radius:50%; border:1px dashed #00000018; outline:1px solid #ffffff90; outline-offset:-1px; box-shadow:inset 0 0 0 6px #ffffff10; pointer-events:none }
  .cauldron.over{ box-shadow:0 0 0 12px #00c8ff30, var(--shadow-strong) }

  /* Brew (inside bowl): continuous stir + blur ramp while waiting */
  .brew{ position:absolute; inset:0; border-radius:50%; overflow:hidden; filter:blur(var(--blur)) saturate(1.06); }
  @keyframes breatheSpin {
    0%   { transform: scale(.985) rotate(-1.2deg); }
    50%  { transform: scale(1.015) rotate( 1.2deg); }
    100% { transform: scale(.985) rotate(-1.2deg); }
  }
  .waiting .brew{ animation: breatheSpin 1.3s ease-in-out infinite; }
  @keyframes rampVars { from{ --shake-ampl:0; --blur:0px; } to{ --shake-ampl:1; --blur:3px; } }
  body.waiting{ animation: rampVars 3s ease-in-out forwards; }

  .liquid, .beams { position:absolute; inset:10%; border-radius:50%; pointer-events:none; opacity:0; }
  .waiting .liquid{ opacity:1; }
  .waiting .beams{ opacity:.8; }
  .liquid{
    background:
      radial-gradient(40% 60% at 30% 30%, #ffffffd0, #ffffff10 70%),
      conic-gradient(from 0deg, #bffbe7 0 40%, #dfe8ff 40% 70%, #ffdff2 70% 100%);
    mix-blend-mode:soft-light; filter:saturate(1.1);
    animation:swirl 3.6s linear infinite;
  }
  @keyframes swirl{to{transform:rotate(360deg)}}
  .beams{
    background: conic-gradient(from 0deg, #ffffff00 0 8%, #ffffff55 10% 12%, #ffffff00 14% 26%, #ffffff55 28% 30%, #ffffff00 32% 44%, #ffffff55 46% 48%, #ffffff00 50% 100%);
    animation:beams 2.6s linear infinite; filter:blur(6px);
  }
  @keyframes beams{to{transform:rotate(-360deg)}}

  /* Image */
  .image-wrap{ position:absolute; inset:0; border-radius:50%; overflow:hidden; z-index:10; }
  .result-img{
    width:100%; height:100%; object-fit:cover; display:block;
    opacity:0; transform:scale(.2);
    transition:opacity .6s var(--ease), transform .9s cubic-bezier(.22,1.2,.22,1);
    pointer-events:auto; -webkit-touch-callout:default; user-select:none;
  }
  .result-img.revealed{ opacity:1; transform:scale(1) }

  /* Tokens overlay (always interactive) */
  .overlay{ position:absolute; inset:0; pointer-events:none; z-index:30; }
  .seeds{ position:fixed; inset:0; z-index:25; pointer-events:none; }

  .seed,.chip,.plus,.cancel{
    width:56px; height:56px; border-radius:50%;
    display:grid; place-items:center; user-select:none;
    background:radial-gradient(120% 120% at 30% 30%, #ffffffcc, #ffffff9a 60%, #ffffff7a 100%);
    box-shadow:var(--shadow), inset 0 1px 0 #ffffffc8, 0 0 0 1px #0001;
  }
  .seed{ position:absolute; transform:translate(-50%,-50%); pointer-events:auto; animation:float var(--dur,9s) ease-in-out infinite var(--delay,0s); }
  @keyframes float{
    0%{transform:translate(calc(-50% + var(--fx,0px)), calc(-50% + var(--fy,0px)))} 
    50%{transform:translate(calc(-50% + var(--fx,0px)), calc(-50% + var(--fy,0px) - 6px))}
    100%{transform:translate(calc(-50% + var(--fx,0px)), calc(-50% + var(--fy,0px)))}
  }
  .seed .e{font-size:36px}

  /* (TRUNCATED IN ORIGINAL) â€” completed below */
  .placed{
    position:absolute; width:12vmin; max-width:80px; aspect-ratio:1; border-radius:50%;
    display:grid; place-items:center; cursor:grab; pointer-events:auto;
    background:radial-gradient(120% 120% at 30% 30%, #ffffffc0, #ffffff80 60%, #ffffff50 100%);
    box-shadow:var(--shadow), inset 0 1px 0 #ffffffb8;
    transform:translate(-50%,-50%) scale(1);
    transition:transform .25s var(--ease), opacity .25s var(--ease), box-shadow .2s var(--ease);
  }
  .placed:active{ cursor:grabbing; transform:translate(-50%,-50%) scale(.98) }
  .placed .e{ font-size:min(8vmin,56px) }

  /* ---------- BUTTONS ROW ---------- */
  .controls{
    display:flex; justify-content:center; gap:16px; padding:6px 0 2px;
    align-items:center;
  }
  .plus,.cancel{ position:relative }
  .plus::after,.cancel::after{
    content:""; position:absolute; inset:0; border-radius:50%;
    box-shadow:inset 0 0 0 1px #00000010;
    -webkit-mask-image: radial-gradient(white, transparent 65%);
            mask-image: radial-gradient(white, transparent 65%);
  }
  .plus:active,.cancel:active{ transform:translateY(1px) scale(.985) }
  .plus .e,.cancel .e{ font-size:28px }

  /* ---------- CAROUSEL AT BOTTOM ---------- */
  .carousel{
    position:relative;
    display:grid; align-items:center;
    overflow-x:auto; overflow-y:hidden; /* prevent vertical drag */
    touch-action:pan-x;                 /* **surgical**: horizontal only */
    -webkit-overflow-scrolling:touch;
    scroll-snap-type:x mandatory;
    gap:10px; padding:10px 6px;
    border-radius:16px; background:#ffffff90; backdrop-filter:saturate(1.1) blur(6px);
    box-shadow:var(--shadow), inset 0 1px 0 #ffffffd0;
    grid-auto-flow:column; grid-auto-columns:max-content;
  }
  .chip{
    min-width:60px; min-height:60px;
    scroll-snap-align:center;
    display:grid; place-items:center;
    transition:transform .2s var(--ease), box-shadow .2s var(--ease), background .2s var(--ease);
  }
  .chip .e{ font-size:32px }
  .chip.active{
    transform:scale(1.12);
    box-shadow:0 6px 20px #0000001f, inset 0 1px 0 #ffffffc8;
    background:radial-gradient(120% 120% at 30% 30%, #ffffffee, #ffffffb8 60%, #ffffff8a 100%);
  }

  /* Utility */
  .sr{ position:absolute; width:1px; height:1px; overflow:hidden; clip:rect(0 0 0 0); white-space:nowrap }
</style>
</head>
<body>
  <div class="stage">
    <!-- Bowl -->
    <div class="centerWrap">
      <div class="cauldron-wrap" id="bowl">
        <div class="cauldron" id="cauldron">
          <div class="brew">
            <div class="liquid"></div>
            <div class="beams"></div>
          </div>
          <div class="image-wrap">
            <img id="result" class="result-img" alt=""/>
          </div>
          <div class="ring"></div>
          <div class="overlay" id="overlay"></div>
        </div>
      </div>
    </div>

    <!-- Buttons row (near the bowl) -->
    <div class="controls">
      <button class="plus" id="btnPlus" aria-label="Add">
        <span class="e">â•</span>
      </button>
      <button class="cancel" id="btnCancel" aria-label="Clear">
        <span class="e">âœ–ï¸</span>
      </button>
    </div>

    <!-- Bottom carousel -->
    <div class="carousel" id="carousel" aria-label="Emoji carousel">
      <!-- chips are injected -->
    </div>
  </div>

  <!-- Seeds floating around the scene -->
  <div class="seeds" id="seeds"></div>

<script>
/* ------- Minimal runtime to render UI and keep it functional ------- */

/* Data: sample emojis (no labels, no text). */
const EMOJIS = [
  "ğŸŒ¸","ğŸ”¥","ğŸŒŠ","ğŸŒ¿","â­ï¸","ğŸª„","ğŸ’","ğŸŒ™","âš¡ï¸","ğŸƒ","ğŸŒ€","ğŸŒˆ",
  "ğŸŠ","ğŸŒ¶ï¸","ğŸ«","ğŸ§Š","â˜ï¸","ğŸŒ°","ğŸªµ","ğŸª™","ğŸ§ª","ğŸˆ","ğŸ§µ","ğŸ§©",
  "ğŸ¾","ğŸ¦‹","ğŸš","ğŸ“","ğŸ‹","ğŸ‡","ğŸ’","ğŸ¥","ğŸŒ»","ğŸŒ¼","ğŸª·","ğŸ€"
];

/* Elements */
const seedsWrap = document.getElementById('seeds');
const overlay = document.getElementById('overlay');
const cauldron = document.getElementById('cauldron');
const carousel = document.getElementById('carousel');
const btnPlus = document.getElementById('btnPlus');
const btnCancel = document.getElementById('btnCancel');

/* Create floating seeds around (no room â€œpopulationâ€ inside the bowl). */
function spawnFloatingSeeds() {
  seedsWrap.innerHTML = '';
  const W = window.innerWidth, H = window.innerHeight;
  const cx = W/2, cy = H/2;
  const radius = Math.min(Math.min(W,H)*0.42, 300);

  for (let i=0; i<18; i++){
    const a = (i/18)*Math.PI*2 + (Math.random()*0.6-0.3);
    const r = radius + (Math.random()*40-20);
    const x = cx + Math.cos(a)*r;
    const y = cy + Math.sin(a)*r;

    const s = document.createElement('div');
    s.className = 'seed';
    s.style.left = x+'px';
    s.style.top  = y+'px';
    s.style.setProperty('--fx', (Math.random()*8-4)+'px');
    s.style.setProperty('--fy', (Math.random()*8-4)+'px');
    s.style.setProperty('--dur', (8+Math.random()*4)+'s');
    s.style.setProperty('--delay', (Math.random()*-6)+'s');
    s.innerHTML = `<div class="e">${EMOJIS[(Math.random()*EMOJIS.length)|0]}</div>`;
    // Tap to bring inside as a placed token
    s.addEventListener('click', () => placeTokenAtCenter(s.textContent));
    seedsWrap.appendChild(s);
  }
}

/* Place a token inside the bowl (center with slight jitter) */
function placeTokenAtCenter(emoji){
  const rect = cauldron.getBoundingClientRect();
  const x = rect.left + rect.width/2 + (Math.random()*20-10);
  const y = rect.top + rect.height/2 + (Math.random()*20-10);
  placeToken(emoji, x, y);
}

/* Draggable placed token */
function placeToken(emoji, pageX, pageY){
  const p = document.createElement('div');
  p.className = 'placed';
  p.style.left = pageX+'px';
  p.style.top  = pageY+'px';
  p.innerHTML = `<div class="e">${emoji}</div>`;
  overlay.appendChild(p);

  // drag
  let dragging=false, ox=0, oy=0;
  p.addEventListener('pointerdown', (e)=>{
    dragging = true; p.setPointerCapture(e.pointerId);
    ox = e.clientX - p.offsetLeft; oy = e.clientY - p.offsetTop;
  });
  p.addEventListener('pointermove', (e)=>{
    if(!dragging) return;
    p.style.left = (e.clientX - ox)+'px';
    p.style.top  = (e.clientY - oy)+'px';
  });
  p.addEventListener('pointerup', ()=> dragging=false);
}

/* Build carousel chips and keep selection pronounced */
function buildCarousel(){
  carousel.innerHTML = '';
  EMOJIS.forEach((em,i)=>{
    const c = document.createElement('button');
    c.className = 'chip';
    c.setAttribute('aria-label','');
    c.innerHTML = `<div class="e">${em}</div>`;
    c.addEventListener('click', ()=>{
      document.querySelectorAll('.chip.active').forEach(n=>n.classList.remove('active'));
      c.classList.add('active');
      // also drop into bowl center on tap
      placeTokenAtCenter(em);
    });
    if(i===0) c.classList.add('active');
    carousel.appendChild(c);
  });
}

/* Buttons: add (clone active), clear all placed */
btnPlus.addEventListener('click', ()=>{
  const active = document.querySelector('.chip.active .e')?.textContent || EMOJIS[0];
  pulseWait(700);
  placeTokenAtCenter(active);
});
btnCancel.addEventListener('click', ()=>{
  overlay.innerHTML = '';
});

/* Waiting pulse for brew visuals */
function pulseWait(ms=900){
  document.body.classList.add('waiting');
  setTimeout(()=>document.body.classList.remove('waiting'), ms);
}

/* Prevent vertical drag on carousel beyond CSS (older browsers fallback) */
let touchStartY = null, touchStartX = null;
carousel.addEventListener('touchstart', (e)=>{
  if(e.touches.length===1){
    touchStartY = e.touches[0].clientY;
    touchStartX = e.touches[0].clientX;
  }
}, {passive:true});
carousel.addEventListener('touchmove', (e)=>{
  if(touchStartY==null) return;
  const dy = Math.abs(e.touches[0].clientY - touchStartY);
  const dx = Math.abs(e.touches[0].clientX - touchStartX);
  if(dy > dx){ e.preventDefault(); } // block vertical movement
}, {passive:false});
carousel.addEventListener('touchend', ()=>{ touchStartY=null; touchStartX=null; });

/* Init */
buildCarousel();
spawnFloatingSeeds();
window.addEventListener('resize', spawnFloatingSeeds);
</script>
</body>
</html>